{{/*
Horizontal scroll shortcode

Usage:
  - Use this shortcode inside page content to render a horizontal scroller of document preview cards.
  - Provide inner markdown (a list of links) or set the `folder` parameter to auto-enumerate a StaticFiles folder.

Behavior:
  - If inner markdown is provided, each list item link becomes a preview card.
  - Otherwise, files under `folder` (default `/uploads/ProofOfAchievements/`) are enumerated and shown.
*/}}

<div class="h-scroll-docs">
  {{ with .Get "title" }}
    <h4 class="h-scroll-title">{{ . | safeHTML }}</h4>
  {{ end }}

  {{ $folder := .Get "folder" | default "/uploads/ProofOfAchievements/" }}

  {{ if gt (len (plainify .Inner)) 0 }}
    {{ $html := .Inner | markdownify }}
    {{ $cards := replaceRE `(?s)<li>\s*<a href="([^"]+)"[^>]*>([^<]+)</a>\s*</li>` (printf "<div class=\"doc-card\">\n  <div class=\"doc-preview-wrap\">\n    <iframe src=\"$1\" class=\"doc-preview\" loading=\"lazy\" title=\"$2\"></iframe>\n  </div>\n  <p class=\"doc-caption\"><a href=\"$1\" target=\"_blank\" rel=\"noopener\">$2</a></p>\n</div>") $html }}
    <div class="h-scroll-row-cards">{{ $cards | safeHTML }}</div>
  {{ else }}
    <div class="h-scroll-row-cards">
      {{ range .Site.StaticFiles }}
        {{ $rel := .RelPermalink }}
        {{ if and (hasPrefix $rel $folder) (or (hasSuffix $rel ".pdf") (hasSuffix $rel ".PDF")) }}
          <div class="doc-card">
            <div class="doc-preview-wrap">
              <iframe src="{{ $rel }}" class="doc-preview" loading="lazy" title="{{ .Name }}"></iframe>
            </div>
            <p class="doc-caption"><a href="{{ $rel }}" target="_blank" rel="noopener">{{ .Name }}</a></p>
          </div>
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
</div>
